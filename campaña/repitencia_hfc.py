import pandas as pd
from sqlalchemy import NVARCHAR, Integer


def importa_repithfc(gc, engine):
    # REPITENCIA HFC
    ws = gc.open_by_key('1eHpX2MyDZH-fgLHwnA4JXzSt_et4c2PuF0RD5M1QCpA').sheet1
    data = pd.DataFrame(ws.get_all_records())
    data.columns = ['Marca temporal', 'Usuario Evaluador', 'Perfil Evaluador', 'SN - Cod',
                    'Fecha llamada', 'Usuario Asesor', 'Teléfono Cliente', 'Nombre Cliente',
                    'TMO', 'SOT - Caso', 'Motivo', 'Detalle llamada',
                    'SUMINISTRA INFORMACIÓN - SUMINISTRA INFORMACIÓN INCOMPLETA',
                    'SUMINISTRA INFORMACIÓN - SUMINISTRA INFORMACIÓN INCORRECTA',
                    'AMABILIDAD Y EMPATÍA - EXCESO DE CONFIANZA CON EL UF',
                    'AMABILIDAD Y EMPATÍA - DEMUESTRA MALA ACTITUD',
                    'ESCUCHA ACTIVA - SOLICITA/CONFIRMA MÁS DE UNA VEZ UNA INFORMACIÓN INNECESARIAMENTE',
                    'ESCUCHA ACTIVA - NO PRESTA ATENCIÓN A COMENTARIOS/SOLICITUDES DE UF',
                    'ESCUCHA ACTIVA - SILENCIOS INCÓMODOS',
                    'ABANDONO DE LLAMADA - ABANDONA AL CLIENTE EN LA ESPERA',
                    'ABANDONO DE LLAMADA - CUELGA DELIBERADAMENTE LA LLAMADA',
                    'MANEJO DE TIEMPOS - EXCEDE EL TIEMPO DE ESPERA PERMITIDO',
                    'MANEJO DE TIEMPOS - NO ATIENDE LA LLAMADA EN EL TIEMPO ESTABLECIDO',
                    'MANEJO DE TIEMPOS - SOLICITA TIEMPOS DE ESPERA INNECESARIOS',
                    'SOLUCIÓN ALTERNATIVA - RESUELVE LAS SOLICITUDES SIN NECESIDAD DE DERIVARLAS',
                    'SOLUCIÓN ALTERNATIVA - RESUELVE TODAS LAS DUDAS APLICABLES DEL UF',
                    'TIPIFICACIÓN - PLANTILLA INCORRECTA',
                    'TIPIFICACIÓN - TIPIFICA DE MANERA COMPLETA EN APLICATIVOS',
                    'TIPIFICACIÓN - TIPIFICA DE MANERA CORRECTA EN APLICATIVOS',
                    'TIPIFICACIÓN - TIPIFICA EN APLICATIVOS',
                    'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - ACTUALIZACIÓN REGISTRO CES',
                    'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - ALERTA AL VOC POR POSIBLE AVERIA',
                    'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - CARGA NAVICAT',
                    'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - CIERRA DE VARIACIÓN / INCIDENCIA',
                    'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - DESCARTES PARA ENTREGA DE SOLUCIÓN',
                    'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - GENERACIÓN DE SOT',
                    'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - GESTIÓN DE REAGENDAMIENTO CORRECTO',
                    'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - REFUERZO CRQ',
                    'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - REPORTAR DE MANERA PREVENTIVA - PLANOS REV',
                    'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - SONDEO PARA IDENTIFICAR LA SOLICITUD',
                    'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - USO DE APLICATIVOS',
                    'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - VALIDACIÓN DE DATOS',
                    'APLICACIÓN DE PROTOCOLOS DE BIENVENIDA Y DESPEDIDA - NO IDENDETIFICA AL INTERLOCUTOR',
                    'APLICACIÓN DE PROTOCOLOS DE BIENVENIDA Y DESPEDIDA - NO SALUDA CORRECTAMENTE',
                    'APLICACIÓN DE PROTOCOLOS DE BIENVENIDA Y DESPEDIDA - NO SE DESPIDE CORRECTAMENTE',
                    'HABILIDADES DE EXPRESIÓN - ASESOR TUTEA AL CLIENTE',
                    'HABILIDADES DE EXPRESIÓN - INTERRUMPE AL CLIENTE',
                    'HABILIDADES DE EXPRESIÓN - LENGUAJE ADECUADO Y ENTONACIÓN DE LA VOZ',
                    'HABILIDADES DE EXPRESIÓN - MULETILLAS / ESCUCHA ACTIVA',
                    'HABILIDADES DE EXPRESIÓN - NO PERSONALIZA',
                    'HABILIDADES DE EXPRESIÓN - UTILIZA UN LENGUAJE INAPROPIADO CON EL UF',
                    'ORTOGRAFÍA Y REDACCIÓN - PRESENTA ERRORES GRAMATICALES',
                    'MANEJO DE LLAMADAS - MANEJO DE CLIENTES CRITICOS',
                    'APLICACIÓN DE PROTOCOLOS DE ESPERA - NO INDICA EL MOTIVO DE ESPERA',
                    'APLICACIÓN DE PROTOCOLOS DE ESPERA - NO RETOMA AGRADECIENDO LA ESPERA',
                    'Observaciones']

    data.to_sql('REPITENCIA_HFC',
                con=engine,
                if_exists='replace',
                dtype={'Marca temporal': NVARCHAR(length=100),
                       'Usuario Evaluador': NVARCHAR(length=100),
                       'Perfil Evaluador': NVARCHAR(length=50),
                       'SN - Cod': NVARCHAR(length=20),
                       'Fecha llamada': NVARCHAR(length=100),
                       'Usuario Asesor': NVARCHAR(length=100),
                       'Teléfono Cliente': NVARCHAR(length=20),
                       'Nombre Cliente': NVARCHAR(length=100),
                       'TMO': Integer(),
                       'SOT - Caso': NVARCHAR(length=20),
                       'Motivo': NVARCHAR(length=100),
                       'Detalle llamada': NVARCHAR(length=3500),
                       'SUMINISTRA INFORMACIÓN - SUMINISTRA INFORMACIÓN INCOMPLETA': NVARCHAR(length=4),
                       'SUMINISTRA INFORMACIÓN - SUMINISTRA INFORMACIÓN INCORRECTA': NVARCHAR(length=4),
                       'AMABILIDAD Y EMPATÍA - EXCESO DE CONFIANZA CON EL UF': NVARCHAR(length=4),
                       'AMABILIDAD Y EMPATÍA - DEMUESTRA MALA ACTITUD': NVARCHAR(length=4),
                       'ESCUCHA ACTIVA - SOLICITA/CONFIRMA MÁS DE UNA VEZ UNA INFORMACIÓN INNECESARIAMENTE': NVARCHAR(length=4),
                       'ESCUCHA ACTIVA - NO PRESTA ATENCIÓN A COMENTARIOS/SOLICITUDES DE UF': NVARCHAR(length=4),
                       'ESCUCHA ACTIVA - SILENCIOS INCÓMODOS': NVARCHAR(length=4),
                       'ABANDONO DE LLAMADA - ABANDONA AL CLIENTE EN LA ESPERA': NVARCHAR(length=4),
                       'ABANDONO DE LLAMADA - CUELGA DELIBERADAMENTE LA LLAMADA': NVARCHAR(length=4),
                       'MANEJO DE TIEMPOS - EXCEDE EL TIEMPO DE ESPERA PERMITIDO': NVARCHAR(length=4),
                       'MANEJO DE TIEMPOS - NO ATIENDE LA LLAMADA EN EL TIEMPO ESTABLECIDO': NVARCHAR(length=4),
                       'MANEJO DE TIEMPOS - SOLICITA TIEMPOS DE ESPERA INNECESARIOS': NVARCHAR(length=4),
                       'SOLUCIÓN ALTERNATIVA - RESUELVE LAS SOLICITUDES SIN NECESIDAD DE DERIVARLAS': NVARCHAR(length=4),
                       'SOLUCIÓN ALTERNATIVA - RESUELVE TODAS LAS DUDAS APLICABLES DEL UF': NVARCHAR(length=4),
                       'TIPIFICACIÓN - PLANTILLA INCORRECTA': NVARCHAR(length=4),
                       'TIPIFICACIÓN - TIPIFICA DE MANERA COMPLETA EN APLICATIVOS': NVARCHAR(length=4),
                       'TIPIFICACIÓN - TIPIFICA DE MANERA CORRECTA EN APLICATIVOS': NVARCHAR(length=4),
                       'TIPIFICACIÓN - TIPIFICA EN APLICATIVOS': NVARCHAR(length=4),
                       'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - ACTUALIZACIÓN REGISTRO CES': NVARCHAR(length=4),
                       'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - ALERTA AL VOC POR POSIBLE AVERIA': NVARCHAR(length=4),
                       'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - CARGA NAVICAT': NVARCHAR(length=4),
                       'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - CIERRA DE VARIACIÓN / INCIDENCIA': NVARCHAR(length=4),
                       'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - DESCARTES PARA ENTREGA DE SOLUCIÓN': NVARCHAR(length=4),
                       'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - GENERACIÓN DE SOT': NVARCHAR(length=4),
                       'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - GESTIÓN DE REAGENDAMIENTO CORRECTO': NVARCHAR(length=4),
                       'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - REFUERZO CRQ': NVARCHAR(length=4),
                       'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - REPORTAR DE MANERA PREVENTIVA - PLANOS REV': NVARCHAR(length=4),
                       'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - SONDEO PARA IDENTIFICAR LA SOLICITUD': NVARCHAR(length=4),
                       'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - USO DE APLICATIVOS': NVARCHAR(length=4),
                       'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - VALIDACIÓN DE DATOS': NVARCHAR(length=4),
                       'APLICACIÓN DE PROTOCOLOS DE BIENVENIDA Y DESPEDIDA - NO IDENDETIFICA AL INTERLOCUTOR': NVARCHAR(length=4),
                       'APLICACIÓN DE PROTOCOLOS DE BIENVENIDA Y DESPEDIDA - NO SALUDA CORRECTAMENTE': NVARCHAR(length=4),
                       'APLICACIÓN DE PROTOCOLOS DE BIENVENIDA Y DESPEDIDA - NO SE DESPIDE CORRECTAMENTE': NVARCHAR(length=4),
                       'HABILIDADES DE EXPRESIÓN - ASESOR TUTEA AL CLIENTE': NVARCHAR(length=4),
                       'HABILIDADES DE EXPRESIÓN - INTERRUMPE AL CLIENTE': NVARCHAR(length=4),
                       'HABILIDADES DE EXPRESIÓN - LENGUAJE ADECUADO Y ENTONACIÓN DE LA VOZ': NVARCHAR(length=4),
                       'HABILIDADES DE EXPRESIÓN - MULETILLAS / ESCUCHA ACTIVA': NVARCHAR(length=4),
                       'HABILIDADES DE EXPRESIÓN - NO PERSONALIZA': NVARCHAR(length=4),
                       'HABILIDADES DE EXPRESIÓN - UTILIZA UN LENGUAJE INAPROPIADO CON EL UF': NVARCHAR(length=4),
                       'ORTOGRAFÍA Y REDACCIÓN - PRESENTA ERRORES GRAMATICALES': NVARCHAR(length=4),
                       'MANEJO DE LLAMADAS - MANEJO DE CLIENTES CRITICOS': NVARCHAR(length=4),
                       'APLICACIÓN DE PROTOCOLOS DE ESPERA - NO INDICA EL MOTIVO DE ESPERA': NVARCHAR(length=4),
                       'APLICACIÓN DE PROTOCOLOS DE ESPERA - NO RETOMA AGRADECIENDO LA ESPERA': NVARCHAR(length=4),
                       'Observaciones': NVARCHAR(length=3500)})
