import pandas as pd
from sqlalchemy import NVARCHAR, Integer


def importa_repithfc(gc, engine):
    # REPITENCIA HFC
    ws = gc.open_by_key('1ilTQZkUIZV_q7TU8bbR7nUuX2DC5ORmS-JDcX_6NEz4').sheet1
    data = pd.DataFrame(ws.get_all_records())
    data.columns = ['Marca temporal', 'Usuario Evaluador', 'Perfil Evaluador', 'SN - Cod',
                    'Fecha llamada', 'Usuario Asesor', 'Teléfono Cliente', 'Nombre Cliente',
                    'TMO', 'SOT - Caso', 'Motivo', 'Detalle llamada',
                    'SUMINISTRA INFORMACIÓN - SUMINISTRA INFORMACIÓN INCOMPLETA',
                    'SUMINISTRA INFORMACIÓN - SUMINISTRA INFORMACIÓN INCORRECTA',
                    'AMABILIDAD Y EMPATÍA - DEMUESTRA MALA ACTITUD',
                    'AMABILIDAD Y EMPATÍA - EXCESO DE CONFIANZA CON EL UF',
                    'AMABILIDAD Y EMPATÍA - INTERRUMPE ABRUPTAMENTE AL CLIENTE',
                    'ESCUCHA ACTIVA - NO PRESTA ATENCIÓN A COMENTARIOS/SOLICITUDES DE UF',
                    'ESCUCHA ACTIVA - SOLICITA/CONFIRMA MÁS DE UNA VEZ UNA INFORMACIÓN INNECESARIAMENTE',
                    'ABANDONO DE LLAMADA - ABANDONA AL CLIENTE EN LA ESPERA',
                    'ABANDONO DE LLAMADA - CUELGA DELIBERADAMENTE LA LLAMADA',
                    'MANEJO DE TIEMPOS - EXCEDE EL TIEMPO DE ESPERA PERMITIDO',
                    'MANEJO DE TIEMPOS - NO ATIENDE LA LLAMADA EN EL TIEMPO ESTABLECIDO',
                    'MANEJO DE TIEMPOS - SOLICITA TIEMPOS DE ESPERA INNECESARIOS',
                    'TIPIFICACIÓN - NO TIPIFICA DE MANERA COMPLETA EN APLICATIVOS DE CLARO',
                    'TIPIFICACIÓN - NO TIPIFICA EN APLICATIVOS',
                    'TIPIFICACIÓN - TIPIFICA DE MANERA INCORRECTA EN APLICATIVOS DE CLARO',
                    'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - ANALISIS PARA ENTREGA DE SOLUCIÓN',
                    'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - DERIVACIÓN CASUISTICAS',
                    'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - DESCARTES CON APLICATIVOS',
                    'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - SONDEO PARA IDENTIFICAR EL PROBLEMA',
                    'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - SPEECH DE USO DE LOS APLICATIVOS',
                    'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - VALIDACIÓN DE DATOS',
                    'APLICACIÓN DE PROTOCOLOS DE BIENVENIDA Y DESPEDIDA - NO IDENTIFICA INTERLOCUTOR',
                    'APLICACIÓN DE PROTOCOLOS DE BIENVENIDA Y DESPEDIDA - NO SALUDA CORRECTAMENTE',
                    'APLICACIÓN DE PROTOCOLOS DE BIENVENIDA Y DESPEDIDA - NO SE DESPIDE CORECTAMENTE',
                    'HABILIDADES DE EXPRESIÓN - ASESOR TUTEA AL CLIENTE',
                    'HABILIDADES DE EXPRESIÓN - LENGUAJE ADECUADO Y ENTONACIÓN DE LA VOZ',
                    'HABILIDADES DE EXPRESIÓN - NO PERSONALIZA / MULETILLAS',
                    'HABILIDADES DE EXPRESIÓN - UTILIZA UN LENGUAJE INAPROPIADO CON EL UF',
                    'MANEJO DE LLAMADAS - MANEJO DE CLIENTES CRITICOS',
                    'APLICACIÓN DE PROTOCOLOS DE ESPERA - NO INDICA EL MOTIVO DE ESPERA',
                    'APLICACIÓN DE PROTOCOLOS DE ESPERA - NO RETOMA AGRADECIENDO LA ESPERA',
                    'Observaciones']

    data.to_sql('REPITENCIA_HFC',
                con=engine,
                if_exists='replace',
                dtype={'Marca temporal': NVARCHAR(length=100),
                       'Usuario Evaluador': NVARCHAR(length=100),
                       'Perfil Evaluador': NVARCHAR(length=50),
                       'SN - Cod': NVARCHAR(length=20),
                       'Fecha llamada': NVARCHAR(length=100),
                       'Usuario Asesor': NVARCHAR(length=100),
                       'Teléfono Cliente': NVARCHAR(length=20),
                       'Nombre Cliente': NVARCHAR(length=100),
                       'TMO': Integer(),
                       'SOT - Caso': NVARCHAR(length=20),
                       'Motivo': NVARCHAR(length=100),
                       'Detalle llamada': NVARCHAR(length=3500),
                       'SUMINISTRA INFORMACIÓN - SUMINISTRA INFORMACIÓN INCOMPLETA': NVARCHAR(length=4),
                       'SUMINISTRA INFORMACIÓN - SUMINISTRA INFORMACIÓN INCORRECTA': NVARCHAR(length=4),
                       'AMABILIDAD Y EMPATÍA - DEMUESTRA MALA ACTITUD': NVARCHAR(length=4),
                       'AMABILIDAD Y EMPATÍA - EXCESO DE CONFIANZA CON EL UF': NVARCHAR(length=4),
                       'AMABILIDAD Y EMPATÍA - INTERRUMPE ABRUPTAMENTE AL CLIENTE': NVARCHAR(length=4),
                       'ESCUCHA ACTIVA - NO PRESTA ATENCIÓN A COMENTARIOS/SOLICITUDES DE UF': NVARCHAR(length=4),
                       'ESCUCHA ACTIVA - SOLICITA/CONFIRMA MÁS DE UNA VEZ UNA INFORMACIÓN INNECESARIAMENTE': NVARCHAR(length=4),
                       'ABANDONO DE LLAMADA - ABANDONA AL CLIENTE EN LA ESPERA': NVARCHAR(length=4),
                       'ABANDONO DE LLAMADA - CUELGA DELIBERADAMENTE LA LLAMADA': NVARCHAR(length=4),
                       'MANEJO DE TIEMPOS - EXCEDE EL TIEMPO DE ESPERA PERMITIDO': NVARCHAR(length=4),
                       'MANEJO DE TIEMPOS - NO ATIENDE LA LLAMADA EN EL TIEMPO ESTABLECIDO': NVARCHAR(length=4),
                       'MANEJO DE TIEMPOS - SOLICITA TIEMPOS DE ESPERA INNECESARIOS': NVARCHAR(length=4),
                       'TIPIFICACIÓN - NO TIPIFICA DE MANERA COMPLETA EN APLICATIVOS DE CLARO': NVARCHAR(length=4),
                       'TIPIFICACIÓN - NO TIPIFICA EN APLICATIVOS': NVARCHAR(length=4),
                       'TIPIFICACIÓN - TIPIFICA DE MANERA INCORRECTA EN APLICATIVOS DE CLARO': NVARCHAR(length=4),
                       'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - ANALISIS PARA ENTREGA DE SOLUCIÓN': NVARCHAR(length=4),
                       'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - DERIVACIÓN CASUISTICAS': NVARCHAR(length=4),
                       'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - DESCARTES CON APLICATIVOS': NVARCHAR(length=4),
                       'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - SONDEO PARA IDENTIFICAR EL PROBLEMA': NVARCHAR(length=4),
                       'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - SPEECH DE USO DE LOS APLICATIVOS': NVARCHAR(length=4),
                       'CUMPLE CON EL PROCEDIMIENTO ESTABLECIDO - VALIDACIÓN DE DATOS': NVARCHAR(length=4),
                       'APLICACIÓN DE PROTOCOLOS DE BIENVENIDA Y DESPEDIDA - NO IDENTIFICA INTERLOCUTOR': NVARCHAR(length=4),
                       'APLICACIÓN DE PROTOCOLOS DE BIENVENIDA Y DESPEDIDA - NO SALUDA CORRECTAMENTE': NVARCHAR(length=4),
                       'APLICACIÓN DE PROTOCOLOS DE BIENVENIDA Y DESPEDIDA - NO SE DESPIDE CORECTAMENTE': NVARCHAR(length=4),
                       'HABILIDADES DE EXPRESIÓN - ASESOR TUTEA AL CLIENTE': NVARCHAR(length=4),
                       'HABILIDADES DE EXPRESIÓN - LENGUAJE ADECUADO Y ENTONACIÓN DE LA VOZ': NVARCHAR(length=4),
                       'HABILIDADES DE EXPRESIÓN - NO PERSONALIZA / MULETILLAS': NVARCHAR(length=4),
                       'HABILIDADES DE EXPRESIÓN - UTILIZA UN LENGUAJE INAPROPIADO CON EL UF': NVARCHAR(length=4),
                       'MANEJO DE LLAMADAS - MANEJO DE CLIENTES CRITICOS': NVARCHAR(length=4),
                       'APLICACIÓN DE PROTOCOLOS DE ESPERA - NO INDICA EL MOTIVO DE ESPERA': NVARCHAR(length=4),
                       'APLICACIÓN DE PROTOCOLOS DE ESPERA - NO RETOMA AGRADECIENDO LA ESPERA': NVARCHAR(length=4),
                       'Observaciones': NVARCHAR(length=3500)})
